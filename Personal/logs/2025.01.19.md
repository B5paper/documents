* 尽管现在做的努力都是尽量让所有非线性的行为变成线性，但是真当所有行为都变成线性时，又怀念非线性的失重感，尝试在线性之外找到非线性的领域

* nccl tmp

    * 一个函数同时有类模板参数和函数模板参数，该如何调用？

        比如 struct 中的 static 成员函数？

    * 当 redop 是 copy 时，multi src 和 multi dst 该如何处理？

    * `Primitives<> prims`由谁创建？

        由`RunWorkColl()` -> `runRing()`创建

    * sendPeers 和 recvPeers 中填的是什么内容？是 rank 号吗？

    * 断点 + cuda gdb print 发现 ring->prev 和 ring->next 都是 0

    * `Primitives -> setDataPtrs()`的作用？看起来有点像是通过网络拿到 peer 的信息后，填写当前 primitive 扮演的 role 所对应的 buffer 地址。

    * Input 总为 0，Output 总为 1，那么 SrcBuf 和 DstBuf 又是在哪赋的值？

        在`genericOp` -> `send() / recv()`时赋的模板参数值，并且被赋为 Input 或 Output。

    * 猜想：每一个 primitive 有两块 buffer，一个叫 src，另一个叫 dst，这两块 buffer 可能不在当前 primitive 上。根据不同的 role，猜测两块 buffer 的作用如下：

        * `send()` -> `genericOp<0, 0, 0, 1, Input, -1>(inpIx, -1, eltN, false);`

            src 作为 input，dst 没有用到。从 src 读数据，直接走 transport 层发出去。

        * `sendFromOutput()` -> `genericOp<0, 0, 0, 1, Output, -1>(outIx, -1, eltN, false);`

            src 作为 output，函数的名称又叫 send from output，那么能想到的一种解释是 src 不在当前 device 上，可能是 peer device 的 output，我们直接从它的 output 读数据，并走 transport 层发送。

        * `recv()` -> `genericOp<0, 0, 1, 0, -1, Output>(-1, outIx, eltN, postOp);`

            没有用到 src buf，说明从 transport 层拿到数据后，直接写入到 dst buffer 里。

        * `directRecvCopy()` -> `genericOp<1, 0, 1, 0, -1, Output>(inpIx, outIx, eltN, /*postOp=*/false);`

            这个比较奇怪，src buf 没用上，但是 inpIx 用上了。那我们猜测它是从 transport 层把数据复制到 dst buffer。

        * `copySend()` -> `genericOp<0, 0, 0, 1, Input, Output>(inpIx, outIx, eltN, postOp);`

            input 和 output 都用到了，是否可以理解为直接使用 cuda memcpy 把数据从 src 搬运到 dst？

        * `recvSend()` -> `genericOp<0, 0, 1, 1, -1, -1>(-1, -1, eltN, postOp);`

            input 和 output 都没用到，说明是从 transport 层拿到数据后，直接发送给另一个 transport 层，不把数据存储到 gpu memory 里。

        * `recvCopySend()` -> `genericOp<0, 0, 1, 1, -1, Output>(-1, outIx, eltN, postOp);`

            input 没用上，input idx 也没用上，那么这个和`directRecvCopy()`有什么区别？

            凡是有 copy 的，output 都会用到。

* 概念漫步

* synergy n. 协同，配合

* haptic a. 触觉的