* inotify

    `inotifywait`默认不被安装，需要手动安装:

    ```
    Command 'inotifywait' not found, but can be installed with:
    sudo apt install inotify-tools
    ```

    example:

    `inotifywait -m test_1/`

    此时在`test_1`中执行`ls`，则`inotifywait`的输出为：

    ```
    Setting up watches.
    Watches established.
    test_1/ OPEN,ISDIR 
    test_1/ ACCESS,ISDIR 
    test_1/ CLOSE_NOWRITE,CLOSE,ISDIR
    ```

    继续执行`touch haha.txt`，则有输出：

    ```
    test_1/ CREATE haha.txt
    test_1/ OPEN haha.txt
    test_1/ ATTRIB haha.txt
    test_1/ CLOSE_WRITE,CLOSE haha.txt
    ```

    此时 cpu 几乎没有占用。

    未验证的限制：

    * 不适用于远程文件系统（如 NFS）。

    * 监控大量文件时可能耗尽 inotify 的 watch 句柄（需调整 /proc/sys/fs/inotify/max_user_watches）。

* `read()`是 posix 标准提供的函数，是系统调用

    头文件`<unistd.h>`

    syntax:

    ```cpp
    ssize_t read(int fd, void *buf, size_t count);
    ```

    * `fd`：文件描述符（如通过 open() 打开的文件）。

    * `buf`：存储读取数据的缓冲区。

    * `count`：请求读取的字节数。

    返回值：

    返回实际读取的字节数（ssize_t），可能小于请求的 count（如文件末尾）。

    返回 -1 表示错误（需检查 errno）。

    `fread()`是 C 语言提供的函数，是对系统调用的封装
    
    头文件`<stdio.h>`

    syntax:

    ```cpp
    size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);
    ```

    * `ptr`：存储数据的缓冲区。

    * `size`：每个数据项的字节大小（如 sizeof(int)）。

    * `nmemb`：要读取的数据项数量。

    * `stream`：`FILE*`类型的指针。

    返回值：

    返回成功读取的 数据项数量（size_t），而非字节数。

    若返回值小于 nmemb，可能到达文件末尾（feof()）或出错（ferror()）。

    * 缓冲机制（未验证）

        * `read()`

            * 无缓冲：直接调用内核接口，每次调用触发一次系统调用，效率较低（频繁小数据读取时）。

            * 适合需要精细控制或高性能的场景（如大块数据读取）。

        * `fread()`

            * 带缓冲：C 标准库在用户空间维护缓冲区，减少系统调用次数（如多次小数据读取会合并为一次系统调用）。

            * 适合常规文件操作（如文本/二进制文件逐块读取）。

* `open()`

    头文件：`#include <fcntl.h>  `

    syntax:

    ```c
    int open(const char *pathname, int flags, mode_t mode);  // mode 仅在创建文件时使用
    ```

    打开文件：

    ```c
    int fd = open("msg_1.txt", O_RDONLY);
    if (fd < 0) {
        printf("fail to open file, ret: %d\n", fd);
        return -1;
    }
    ```

    创建新文件：

    ```c
    int fd = open("newfile.txt", O_CREAT, 0644); // 创建文件并设置权限 -rw-r--r--
    ```
