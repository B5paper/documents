* rdma qp type

    In RDMA, there are several QP types. They can be represented by: XY

    X can be:

    **Reliable**: There is a guarantee that messages are delivered at most once, in order and without corruption.

    **Unreliable**: There isn't any guarantee that the messages will be delivered or about the order of the packets.

    In RDMA, every packet has a CRC and corrupted packets are being dropped (for any transport type). The Reliability of a QP transport type refers to the whole message reliability.

    Y can be:

    **Connected**: one QP send/receive with exactly one QP

    **Unconnected**: one QP send/receive with any QP

    因此 qp type 其实被分为 RC, UC, UD (Unreliable Datagram) 这三种。

    Ref: <https://www.rdmamojo.com/2013/06/01/which-queue-pair-type-to-use/>

* `ibv_create_qp()`

    header file: `#include <infiniband/verbs.h>`

    syntax:

    ```c
    struct ibv_qp *ibv_create_qp(struct ibv_pd *pd,
        struct ibv_qp_init_attr *qp_init_attr);

    int ibv_destroy_qp(struct ibv_qp *qp);
    ```

    ```c
    struct ibv_qp_init_attr {
        void *qp_context;
        struct ibv_cq *send_cq;
        struct ibv_cq *recv_cq;
        struct ibv_srq *srq;
        struct ibv_qp_cap cap;
        enum ibv_qp_type qp_type;
        int sq_sig_all;
    };

    struct ibv_qp_cap {
        uint32_t max_send_wr;
        uint32_t max_recv_wr;
        uint32_t max_send_sge;
        uint32_t max_recv_sge;
        uint32_t max_inline_data;
    }
    ```

    Ref: <https://man7.org/linux/man-pages/man3/ibv_create_qp.3.html>

    可以看到`qp_type`是一个`enum ibv_qp_type`的枚举值。

    文档中常用的有三个值：`IBV_QPT_RC`, `IBV_QPT_UC`, `IBV_QPT_UD`

    Ref: <https://www.rdmamojo.com/2012/12/21/ibv_create_qp/>

* 调研`be64toh()`, `endian.h`

* rts 指的是 read to send

    qps 指的是 queue pair state

    rtr: ready to receive state

    sqd: send queue drain state

    sqe: send queue error state

    err: error state

    drain: 耗尽

* sq psn

    `sq_psn`: a 24 bits value of the Packet Sequence Number of the sent packets for any QP.

* 调研 ibv ping pong

    Error: `No space left on device`

* `struct ib_device_ops`在`include/rdma/ib_verbs.h`中，里面定义了一些 rdma-core 所需的 callback function

* test:

    `rdma-core` project 中，`libverbs/examples`里有挺多测试程序的源代码。

    可以拿来测试 ib verbs 基本功能。

