* nccl p2p 在开始数据传输任务后，host 端在 while 循环中进行 poll 检查 sockfd 状态，除此之外无显式的 send recv 操作，说明 p2p 确实是由 device 侧发起的数据搬运操作。

    p2p 模式下，cpu 单核仍会跑满，但是这个是主动循环 poll sockfd 事件导致的，并不是内核在读写 host memory。

    猜测可能是 host 申请一个 sockfd，然后把相关的 buffer 地址以及对应的权限交给 gpu. gpu 走 pcie p2p 和其他 gpu 进行通信，当通信完成后，gpu 会回填这个 sockfd 的 buffer，这个 buffer 里包含了 fd 的状态，代表事件已经完成。host 侧则通过轮询（也不是轮询，其实就是 poll）这个 fd 判断事件是否完成。

    （如果使用 poll，按道理 cpu 应该占用率为零才对，为什么仍会占用 100%？可能是 timeout 设置为 0？不清楚，有时间了看看。）

* 在 ubuntu 22.04 上尝试了 openmpi 版本的 shmem，全是报错，没有成功过

    ```
    (base) hlc@hlc-VirtualBox:~/Documents/Projects/shmem_test$ shmemrun -np 4 ./main
    [hlc-VirtualBox:06026] Error ../../../../../oshmem/mca/memheap/base/memheap_base_static.c:249 - _load_segments() too many segments (max = 32): skip 76ebb7b88000-76ebb7b99000 rw-p 00000000 00:00 0 
    [hlc-VirtualBox:06026] Error ../../../../../oshmem/mca/memheap/base/memheap_base_static.c:249 - _load_segments() too many segments (max = 32): skip 76ebb7c88000-76ebb7c9a000 rw-p 00000000 00:00 0 
    [hlc-VirtualBox:06031] Error ../../../../../oshmem/mca/memheap/base/memheap_base_static.c:249 - _load_segments() too many segments (max = 32): skip 71087b26f000-71087b281000 rw-p 00000000 00:00 0 
    [hlc-VirtualBox:06031] ../../../../../../oshmem/mca/spml/ucx/spml_ucx.c:127  Error: Failed to get new mkey for segment: max number (32) of segment descriptor is exhausted
    [hlc-VirtualBox:06031] ../../../../../../oshmem/mca/spml/ucx/spml_ucx.c:223  Error: mca_spml_ucx_ctx_mkey_new failed
    [hlc-VirtualBox:06031] ../../../../../../oshmem/mca/spml/ucx/spml_ucx.c:736  Error: mca_spml_ucx_ctx_mkey_cache failed
    [hlc-VirtualBox:6031 :0:6031] Caught signal 11 (Segmentation fault: address not mapped to object at address 0x49)
    ==== backtrace (tid:   6031) ====
    0  /lib/x86_64-linux-gnu/libucs.so.0(ucs_handle_error+0x2e4) [0x710878154fc4]
    1  /lib/x86_64-linux-gnu/libucs.so.0(+0x24fec) [0x710878158fec]
    2  /lib/x86_64-linux-gnu/libucs.so.0(+0x251aa) [0x7108781591aa]
    3  /lib/x86_64-linux-gnu/libucp.so.0(+0x35e52) [0x7108781c3e52]
    4  /lib/x86_64-linux-gnu/libucp.so.0(ucp_mem_unmap+0x66) [0x7108781c3f96]
    5  /usr/lib/x86_64-linux-gnu/openmpi/lib/openmpi3/mca_spml_ucx.so(mca_spml_ucx_register+0x247) [0x710879083e07]
    6  /lib/x86_64-linux-gnu/liboshmem.so.40(mca_memheap_base_reg+0x92) [0x71087b238a92]
    7  /lib/x86_64-linux-gnu/liboshmem.so.40(mca_memheap_base_select+0xe4) [0x71087b239824]
    8  /lib/x86_64-linux-gnu/liboshmem.so.40(oshmem_shmem_init+0x238) [0x71087b1b0508]
    9  /lib/x86_64-linux-gnu/liboshmem.so.40(shmem_init+0x50) [0x71087b1b0760]
    10  ./main(+0x11da) [0x58079e7bb1da]
    11  /lib/x86_64-linux-gnu/libc.so.6(+0x29d90) [0x71087ae29d90]
    12  /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80) [0x71087ae29e40]
    13  ./main(+0x1105) [0x58079e7bb105]
    =================================
    [hlc-VirtualBox:06031] *** Process received signal ***
    [hlc-VirtualBox:06031] Signal: Segmentation fault (11)
    [hlc-VirtualBox:06031] Signal code:  (-6)
    [hlc-VirtualBox:06031] Failing at address: 0x3e80000178f
    [hlc-VirtualBox:06031] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x42520)[0x71087ae42520]
    [hlc-VirtualBox:06031] [ 1] /lib/x86_64-linux-gnu/libucp.so.0(+0x35e52)[0x7108781c3e52]
    [hlc-VirtualBox:06031] [ 2] /lib/x86_64-linux-gnu/libucp.so.0(ucp_mem_unmap+0x66)[0x7108781c3f96]
    [hlc-VirtualBox:06031] [ 3] /usr/lib/x86_64-linux-gnu/openmpi/lib/openmpi3/mca_spml_ucx.so(mca_spml_ucx_register+0x247)[0x710879083e07]
    [hlc-VirtualBox:06031] [ 4] /lib/x86_64-linux-gnu/liboshmem.so.40(mca_memheap_base_reg+0x92)[0x71087b238a92]
    [hlc-VirtualBox:06031] [ 5] /lib/x86_64-linux-gnu/liboshmem.so.40(mca_memheap_base_select+0xe4)[0x71087b239824]
    [hlc-VirtualBox:06031] [ 6] /lib/x86_64-linux-gnu/liboshmem.so.40(oshmem_shmem_init+0x238)[0x71087b1b0508]
    [hlc-VirtualBox:06031] [ 7] /lib/x86_64-linux-gnu/liboshmem.so.40(shmem_init+0x50)[0x71087b1b0760]
    [hlc-VirtualBox:06031] [ 8] ./main(+0x11da)[0x58079e7bb1da]
    [hlc-VirtualBox:06031] [ 9] /lib/x86_64-linux-gnu/libc.so.6(+0x29d90)[0x71087ae29d90]
    [hlc-VirtualBox:06031] [10] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80)[0x71087ae29e40]
    [hlc-VirtualBox:06031] [11] ./main(+0x1105)[0x58079e7bb105]
    [hlc-VirtualBox:06031] *** End of error message ***
    --------------------------------------------------------------------------
    Primary job  terminated normally, but 1 process returned
    a non-zero exit code. Per user-direction, the job has been aborted.
    --------------------------------------------------------------------------
    --------------------------------------------------------------------------
    shmemrun noticed that process rank 3 with PID 0 on node hlc-VirtualBox exited on signal 11 (Segmentation fault).
    --------------------------------------------------------------------------
    ```

    ubuntu 2404 上编译器的版本为

    ```
    (base) hlc@ubuntu2404:~$ shmemcc --version
    gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0
    Copyright (C) 2023 Free Software Foundation, Inc.
    This is free software; see the source for copying conditions.  There is NO
    warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

    ```

    ubuntu 2204 上编译器版本为

    ```
    (base) hlc@hlc-VirtualBox:~$ shmemcc --version
    gcc (Ubuntu 12.3.0-1ubuntu1~22.04) 12.3.0
    Copyright (C) 2022 Free Software Foundation, Inc.
    This is free software; see the source for copying conditions.  There is NO
    warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    ```

    不同的编译器、不同的操作系统下有不同的行为，有可能是 openmpi 库有问题。

    两个探索方向：

    1. 換其他版本的 openshmem 实现试一试

    2. 搜报错信息，看看有无解决方案

* 测试了下，51 机器上 rdma + v100 vllm demo 环境已经挂了。看来 fpga 并不能做到长期稳定

* nccl 无法使用`CUDA_VISIBLE_DEVICES`指定具体使用哪块 gpu

    `NVIDIA_VISIBLE_DEVICES`也不行。

* gdb 远程调试

    1. 安装 gdbserver

        `sudo apt install gdbserver`

    2. 在 host A 上创建新目录，写入下面的文件

        `main.c`:

        ```c
        #include <stdio.h>

        int main()
        {
            printf("hello from gdb server\n");
            return 0;
        }
        ```

        编译：`gcc -g main.c -o main`

    3. 在 host A 上使用 gdbserver 运行`main`

        `gdbserver :5432 ./main`

    4. 在 host B 上启动 gdb，加载符号表

        `gdb`

        ```
        (gdb) symbol-file ./main
        Reading symbols from ./main...
        ```

        这里的`./main`必须和 host A 上编译出来的相同才行。

    5. 在 host B 上执行

        `(gdb) target remote  <host_A_ipv4>:4321`

        根据提示操作，即可开始调试。

        ```
        (gdb) c
        Continuing.
        Reading /lib/x86_64-linux-gnu/libc.so.6 from remote target...

        Breakpoint 1, main () at main.c:6
        6	    return 0;
        (gdb) 
        ```

        这中间可能需要联网下载一些符号表。（如果是断网条件下，这些符号表该如何获得？）

* sendrecv -g 2 的 log

    ```
    root@3767c65d25c4:/home/hantian# NCCL_DEBUG=INFO sendrecv_perf -b 128M -e 512M -f 2 -g 2
    # nThread 1 nGpus 2 minBytes 134217728 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 20 agg iters: 1 validation: 1 graph: 0
    #
    # Using devices
    #  Rank  0 Group  0 Pid    706 on 3767c65d25c4 device  0 [0xa4] NVIDIA A100-SXM4-80GB
    #  Rank  1 Group  0 Pid    706 on 3767c65d25c4 device  1 [0xa9] NVIDIA A100-SXM4-80GB
    3767c65d25c4:706:706 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
    3767c65d25c4:706:706 [1] NCCL INFO cudaDriverVersion 12040
    NCCL version 2.20.5+cuda12.4
    3767c65d25c4:706:714 [1] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
    3767c65d25c4:706:714 [1] NCCL INFO P2P plugin IBext_v8
    3767c65d25c4:706:714 [1] NCCL INFO NET/IB : No device found.
    3767c65d25c4:706:714 [1] NCCL INFO NET/IB : No device found.
    3767c65d25c4:706:714 [1] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
    3767c65d25c4:706:714 [1] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:706:714 [1] NCCL INFO Using network Socket
    3767c65d25c4:706:713 [0] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:706:713 [0] NCCL INFO Using network Socket
    3767c65d25c4:706:714 [1] NCCL INFO comm 0x556a7ff6ad20 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId a9000 commId 0xb7f271b6f0f05f4e - Init START
    3767c65d25c4:706:713 [0] NCCL INFO comm 0x556a7ff65b20 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId a4000 commId 0xb7f271b6f0f05f4e - Init START
    3767c65d25c4:706:714 [1] NCCL INFO Setting affinity for GPU 1 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:706:713 [0] NCCL INFO Setting affinity for GPU 0 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:706:714 [1] NCCL INFO comm 0x556a7ff6ad20 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
    3767c65d25c4:706:713 [0] NCCL INFO comm 0x556a7ff65b20 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
    3767c65d25c4:706:714 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] -1/-1/-1->1->0 [5] -1/-1/-1->1->0 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] 0/-1/-1->1->-1 [9] 0/-1/-1->1->-1 [10] 0/-1/-1->1->-1 [11] 0/-1/-1->1->-1 [12] -1/-1/-1->1->0 [13] -1/-1/-1->1->0 [14] -1/-1/-1->1->0 [15] -1/-1/-1->1->0 [16] -1/-1/-1->1->0 [17] -1/-1/-1->1->0 [18] 0/-1/-1->1->-1 [19] 0/-1/-1->1->-1 [20] 0/-1/-1->1->-1 [21] 0/-1/-1->1->-1 [22] 0/-1/-1->1->-1 [23] 0/-1/-1->1->-1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 00/24 :    0   1
    3767c65d25c4:706:714 [1] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:706:713 [0] NCCL INFO Channel 01/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 02/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 03/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 04/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 05/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 06/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 07/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 08/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 09/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 10/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 11/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 12/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 13/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 14/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 15/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 16/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 17/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 18/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 19/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 20/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 21/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 22/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Channel 23/24 :    0   1
    3767c65d25c4:706:713 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] -1/-1/-1->0->1 [9] -1/-1/-1->0->1 [10] -1/-1/-1->0->1 [11] -1/-1/-1->0->1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] -1/-1/-1->0->1 [21] -1/-1/-1->0->1 [22] -1/-1/-1->0->1 [23] -1/-1/-1->0->1
    3767c65d25c4:706:713 [0] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:706:714 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:713 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:714 [1] NCCL INFO Connected all rings
    3767c65d25c4:706:714 [1] NCCL INFO Connected all trees
    3767c65d25c4:706:713 [0] NCCL INFO Connected all rings
    3767c65d25c4:706:714 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
    3767c65d25c4:706:714 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:706:713 [0] NCCL INFO Connected all trees
    3767c65d25c4:706:713 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
    3767c65d25c4:706:713 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:706:713 [0] NCCL INFO NCCL_WORK_FIFO_DEPTH set by environment to 4194304.
    3767c65d25c4:706:713 [0] NCCL INFO comm 0x556a7ff65b20 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId a4000 commId 0xb7f271b6f0f05f4e - Init COMPLETE
    3767c65d25c4:706:714 [1] NCCL INFO comm 0x556a7ff6ad20 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId a9000 commId 0xb7f271b6f0f05f4e - Init COMPLETE
    #
    #                                                              out-of-place                       in-place          
    #       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
    #        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
    3767c65d25c4:706:722 [0] NCCL INFO Channel 00/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 01/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 00/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 02/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 01/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 03/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 02/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 04/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 03/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 05/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 04/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 06/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 05/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 07/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 06/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 08/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 07/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 09/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 08/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 10/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 09/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 11/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 10/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 12/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 11/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 13/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 12/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 14/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 13/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 15/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 14/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 16/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 15/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 17/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 16/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 18/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 17/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 19/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 18/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 20/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 19/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 21/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 20/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 22/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 21/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 23/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 22/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 24/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 23/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 25/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 24/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 26/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 25/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 27/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 26/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 28/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 27/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 29/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 28/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 30/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 29/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:722 [0] NCCL INFO Channel 31/1 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 30/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:706:721 [1] NCCL INFO Channel 31/1 : 1[1] -> 0[0] via P2P/direct pointer/read
    134217728      33554432     float     sum      -1    876.8  153.08  153.08      0    829.1  161.89  161.89    N/A
    268435456      67108864     float     sum      -1   1626.2  165.07  165.07      0   1594.1  168.39  168.39    N/A
    536870912     134217728     float     sum      -1   2541.2  211.27  211.27      0   2526.5  212.50  212.50    N/A
    3767c65d25c4:706:706 [1] NCCL INFO comm 0x556a7ff65b20 rank 0 nranks 2 cudaDev 0 busId a4000 - Destroy COMPLETE
    3767c65d25c4:706:706 [1] NCCL INFO comm 0x556a7ff6ad20 rank 1 nranks 2 cudaDev 1 busId a9000 - Destroy COMPLETE
    # Out of bounds values : 0 OK
    # Avg bus bandwidth    : 178.7 
    #

    ```
* `-g 2`和`-g 4`不会影响 channel 的数量，但会影响拓扑（ring, tree）的数量

    `-g 4`会起 4 ring, 4 tree

    `-g 2`会起 2 ring, 2 tree

* `all_reduce_perf`只用到了 coll channel （24 个），`sendrecv_perf`同时用到了 coll channel，p2p channel （32 个）

* `all_reduce_perf` 4 gpu 的 log

    ```
    root@3767c65d25c4:/home/hantian# NCCL_DEBUG=INFO all_reduce_perf -b 128M -e 512M -f 2 -g 4
    # nThread 1 nGpus 4 minBytes 134217728 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 20 agg iters: 1 validation: 1 graph: 0
    #
    # Using devices
    #  Rank  0 Group  0 Pid    855 on 3767c65d25c4 device  0 [0xa4] NVIDIA A100-SXM4-80GB
    #  Rank  1 Group  0 Pid    855 on 3767c65d25c4 device  1 [0xa9] NVIDIA A100-SXM4-80GB
    #  Rank  2 Group  0 Pid    855 on 3767c65d25c4 device  2 [0xe1] NVIDIA A100-SXM4-80GB
    #  Rank  3 Group  0 Pid    855 on 3767c65d25c4 device  3 [0xe7] NVIDIA A100-SXM4-80GB
    3767c65d25c4:855:855 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
    3767c65d25c4:855:855 [3] NCCL INFO cudaDriverVersion 12040
    NCCL version 2.20.5+cuda12.4
    3767c65d25c4:855:866 [2] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
    3767c65d25c4:855:866 [2] NCCL INFO P2P plugin IBext_v8
    3767c65d25c4:855:866 [2] NCCL INFO NET/IB : No device found.
    3767c65d25c4:855:866 [2] NCCL INFO NET/IB : No device found.
    3767c65d25c4:855:866 [2] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
    3767c65d25c4:855:866 [2] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:855:866 [2] NCCL INFO Using network Socket
    3767c65d25c4:855:864 [0] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:855:864 [0] NCCL INFO Using network Socket
    3767c65d25c4:855:867 [3] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:855:867 [3] NCCL INFO Using network Socket
    3767c65d25c4:855:865 [1] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:855:865 [1] NCCL INFO Using network Socket
    3767c65d25c4:855:865 [1] NCCL INFO comm 0x562b860d2a20 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId a9000 commId 0x40531e6886adf963 - Init START
    3767c65d25c4:855:867 [3] NCCL INFO comm 0x562b860dc3d0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId e7000 commId 0x40531e6886adf963 - Init START
    3767c65d25c4:855:866 [2] NCCL INFO comm 0x562b860d7730 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId e1000 commId 0x40531e6886adf963 - Init START
    3767c65d25c4:855:864 [0] NCCL INFO comm 0x562b860cbf20 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId a4000 commId 0x40531e6886adf963 - Init START
    3767c65d25c4:855:865 [1] NCCL INFO Setting affinity for GPU 1 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:855:865 [1] NCCL INFO NVLS multicast support is not available on dev 1
    3767c65d25c4:855:866 [2] NCCL INFO Setting affinity for GPU 2 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:855:866 [2] NCCL INFO NVLS multicast support is not available on dev 2
    3767c65d25c4:855:867 [3] NCCL INFO Setting affinity for GPU 3 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:855:867 [3] NCCL INFO NVLS multicast support is not available on dev 3
    3767c65d25c4:855:864 [0] NCCL INFO Setting affinity for GPU 0 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:855:864 [0] NCCL INFO NVLS multicast support is not available on dev 0
    3767c65d25c4:855:867 [3] NCCL INFO comm 0x562b860dc3d0 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
    3767c65d25c4:855:866 [2] NCCL INFO comm 0x562b860d7730 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
    3767c65d25c4:855:867 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2 [4] -1/-1/-1->3->2 [5] -1/-1/-1->3->2 [6] -1/-1/-1->3->2 [7] -1/-1/-1->3->2 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] -1/-1/-1->3->2 [11] -1/-1/-1->3->2 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] -1/-1/-1->3->2 [15] -1/-1/-1->3->2 [16] -1/-1/-1->3->2 [17] -1/-1/-1->3->2 [18] -1/-1/-1->3->2 [19] -1/-1/-1->3->2 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] -1/-1/-1->3->2 [23] -1/-1/-1->3->2
    3767c65d25c4:855:865 [1] NCCL INFO comm 0x562b860d2a20 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
    3767c65d25c4:855:864 [0] NCCL INFO comm 0x562b860cbf20 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
    3767c65d25c4:855:866 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1 [4] 3/-1/-1->2->1 [5] 3/-1/-1->2->1 [6] 3/-1/-1->2->1 [7] 3/-1/-1->2->1 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] 3/-1/-1->2->1 [11] 3/-1/-1->2->1 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] 3/-1/-1->2->1 [15] 3/-1/-1->2->1 [16] 3/-1/-1->2->1 [17] 3/-1/-1->2->1 [18] 3/-1/-1->2->1 [19] 3/-1/-1->2->1 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] 3/-1/-1->2->1 [23] 3/-1/-1->2->1
    3767c65d25c4:855:865 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0 [4] 2/-1/-1->1->0 [5] 2/-1/-1->1->0 [6] 2/-1/-1->1->0 [7] 2/-1/-1->1->0 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 2/-1/-1->1->0 [11] 2/-1/-1->1->0 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 2/-1/-1->1->0 [15] 2/-1/-1->1->0 [16] 2/-1/-1->1->0 [17] 2/-1/-1->1->0 [18] 2/-1/-1->1->0 [19] 2/-1/-1->1->0 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 2/-1/-1->1->0 [23] 2/-1/-1->1->0
    3767c65d25c4:855:865 [1] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:855:867 [3] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:855:864 [0] NCCL INFO Channel 00/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 01/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 02/24 :    0   1   2   3
    3767c65d25c4:855:866 [2] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:855:864 [0] NCCL INFO Channel 03/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 04/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 05/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 06/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 07/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 08/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 09/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 10/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 11/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 12/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 13/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 14/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 15/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 16/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 17/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 18/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 19/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 20/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 21/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 22/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Channel 23/24 :    0   1   2   3
    3767c65d25c4:855:864 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] 1/-1/-1->0->-1 [7] 1/-1/-1->0->-1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] 1/-1/-1->0->-1 [19] 1/-1/-1->0->-1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 1/-1/-1->0->-1 [23] 1/-1/-1->0->-1
    3767c65d25c4:855:864 [0] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:855:865 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 04/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 05/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 04/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 06/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 05/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 07/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 06/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 08/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 07/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 09/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 08/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 10/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 09/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 11/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 10/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 12/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 11/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 13/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 12/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 14/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 13/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 04/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 15/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 14/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 05/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 15/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 16/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 16/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 06/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 17/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 17/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 07/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 18/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 18/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 19/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 08/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 19/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 20/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 20/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 09/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 21/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 21/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 10/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 22/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 22/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 11/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 23/0 : 1[1] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 23/0 : 2[2] -> 3[3] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 12/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 13/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 14/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 15/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 16/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 17/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 18/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 19/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 20/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 21/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 22/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 23/0 : 3[3] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Connected all rings
    3767c65d25c4:855:865 [1] NCCL INFO Connected all rings
    3767c65d25c4:855:867 [3] NCCL INFO Connected all rings
    3767c65d25c4:855:864 [0] NCCL INFO Connected all rings
    3767c65d25c4:855:867 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 04/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 05/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 06/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 07/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 08/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 09/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 10/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 11/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 12/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 13/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 14/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 15/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 16/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 17/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 18/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 19/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 20/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 21/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 22/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:867 [3] NCCL INFO Channel 23/0 : 3[3] -> 2[2] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 04/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 05/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 06/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 07/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 08/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 09/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 10/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 11/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 12/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 13/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 14/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 15/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 16/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 17/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 18/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 19/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 20/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:865 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 21/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 22/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:866 [2] NCCL INFO Channel 23/0 : 2[2] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:855:864 [0] NCCL INFO Connected all trees
    3767c65d25c4:855:864 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
    3767c65d25c4:855:864 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:855:865 [1] NCCL INFO Connected all trees
    3767c65d25c4:855:865 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
    3767c65d25c4:855:865 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:855:867 [3] NCCL INFO Connected all trees
    3767c65d25c4:855:866 [2] NCCL INFO Connected all trees
    3767c65d25c4:855:867 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
    3767c65d25c4:855:867 [3] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:855:866 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
    3767c65d25c4:855:866 [2] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:855:864 [0] NCCL INFO NCCL_WORK_FIFO_DEPTH set by environment to 4194304.
    3767c65d25c4:855:864 [0] NCCL INFO comm 0x562b860cbf20 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId a4000 commId 0x40531e6886adf963 - Init COMPLETE
    3767c65d25c4:855:867 [3] NCCL INFO comm 0x562b860dc3d0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId e7000 commId 0x40531e6886adf963 - Init COMPLETE
    3767c65d25c4:855:865 [1] NCCL INFO comm 0x562b860d2a20 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId a9000 commId 0x40531e6886adf963 - Init COMPLETE
    3767c65d25c4:855:866 [2] NCCL INFO comm 0x562b860d7730 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId e1000 commId 0x40531e6886adf963 - Init COMPLETE
    #
    #                                                              out-of-place                       in-place          
    #       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
    #        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
    134217728      33554432     float     sum      -1   1144.4  117.29  175.93      0   1116.5  120.21  180.32      0
    268435456      67108864     float     sum      -1   2157.0  124.45  186.67      0   2159.3  124.31  186.47      0
    536870912     134217728     float     sum      -1   4157.4  129.14  193.70      0   3704.9  144.91  217.36      0
    3767c65d25c4:855:855 [3] NCCL INFO comm 0x562b860cbf20 rank 0 nranks 4 cudaDev 0 busId a4000 - Destroy COMPLETE
    3767c65d25c4:855:855 [3] NCCL INFO comm 0x562b860d2a20 rank 1 nranks 4 cudaDev 1 busId a9000 - Destroy COMPLETE
    3767c65d25c4:855:855 [3] NCCL INFO comm 0x562b860d7730 rank 2 nranks 4 cudaDev 2 busId e1000 - Destroy COMPLETE
    3767c65d25c4:855:855 [3] NCCL INFO comm 0x562b860dc3d0 rank 3 nranks 4 cudaDev 3 busId e7000 - Destroy COMPLETE
    # Out of bounds values : 0 OK
    # Avg bus bandwidth    : 190.076 
    #

    ```

* `all_reduce_perf` 2 gpu 的 log

    这个看起来稍微少一点

    ```
    root@3767c65d25c4:/home/hantian# NCCL_DEBUG=INFO all_reduce_perf -b 128M -e 512M -f 2 -g 2
    # nThread 1 nGpus 2 minBytes 134217728 maxBytes 536870912 step: 2(factor) warmup iters: 5 iters: 20 agg iters: 1 validation: 1 graph: 0
    #
    # Using devices
    #  Rank  0 Group  0 Pid    880 on 3767c65d25c4 device  0 [0xa4] NVIDIA A100-SXM4-80GB
    #  Rank  1 Group  0 Pid    880 on 3767c65d25c4 device  1 [0xa9] NVIDIA A100-SXM4-80GB
    3767c65d25c4:880:880 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
    3767c65d25c4:880:880 [1] NCCL INFO cudaDriverVersion 12040
    NCCL version 2.20.5+cuda12.4
    3767c65d25c4:880:887 [0] NCCL INFO Plugin Path : /opt/hpcx/nccl_rdma_sharp_plugin/lib/libnccl-net.so
    3767c65d25c4:880:887 [0] NCCL INFO P2P plugin IBext_v8
    3767c65d25c4:880:887 [0] NCCL INFO NET/IB : No device found.
    3767c65d25c4:880:887 [0] NCCL INFO NET/IB : No device found.
    3767c65d25c4:880:887 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
    3767c65d25c4:880:887 [0] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:880:887 [0] NCCL INFO Using network Socket
    3767c65d25c4:880:888 [1] NCCL INFO Using non-device net plugin version 0
    3767c65d25c4:880:888 [1] NCCL INFO Using network Socket
    3767c65d25c4:880:887 [0] NCCL INFO comm 0x55ba65abd9d0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId a4000 commId 0xab55a18c6f2a4343 - Init START
    3767c65d25c4:880:888 [1] NCCL INFO comm 0x55ba65ac2bd0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId a9000 commId 0xab55a18c6f2a4343 - Init START
    3767c65d25c4:880:888 [1] NCCL INFO Setting affinity for GPU 1 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:880:887 [0] NCCL INFO Setting affinity for GPU 0 to 7fffffff,ffffffff,00000000,00000000,ffffffff,ffffffff,00000000,00000000
    3767c65d25c4:880:888 [1] NCCL INFO comm 0x55ba65ac2bd0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
    3767c65d25c4:880:887 [0] NCCL INFO comm 0x55ba65abd9d0 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
    3767c65d25c4:880:888 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] -1/-1/-1->1->0 [5] -1/-1/-1->1->0 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] 0/-1/-1->1->-1 [9] 0/-1/-1->1->-1 [10] 0/-1/-1->1->-1 [11] 0/-1/-1->1->-1 [12] -1/-1/-1->1->0 [13] -1/-1/-1->1->0 [14] -1/-1/-1->1->0 [15] -1/-1/-1->1->0 [16] -1/-1/-1->1->0 [17] -1/-1/-1->1->0 [18] 0/-1/-1->1->-1 [19] 0/-1/-1->1->-1 [20] 0/-1/-1->1->-1 [21] 0/-1/-1->1->-1 [22] 0/-1/-1->1->-1 [23] 0/-1/-1->1->-1
    3767c65d25c4:880:888 [1] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:880:887 [0] NCCL INFO Channel 00/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 01/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 02/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 03/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 04/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 05/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 06/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 07/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 08/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 09/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 10/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 11/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 12/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 13/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 14/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 15/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 16/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 17/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 18/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 19/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 20/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 21/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 22/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Channel 23/24 :    0   1
    3767c65d25c4:880:887 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] -1/-1/-1->0->1 [9] -1/-1/-1->0->1 [10] -1/-1/-1->0->1 [11] -1/-1/-1->0->1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] -1/-1/-1->0->1 [21] -1/-1/-1->0->1 [22] -1/-1/-1->0->1 [23] -1/-1/-1->0->1
    3767c65d25c4:880:887 [0] NCCL INFO P2P Chunksize set to 524288
    3767c65d25c4:880:888 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:887 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
    3767c65d25c4:880:888 [1] NCCL INFO Connected all rings
    3767c65d25c4:880:887 [0] NCCL INFO Connected all rings
    3767c65d25c4:880:887 [0] NCCL INFO Connected all trees
    3767c65d25c4:880:888 [1] NCCL INFO Connected all trees
    3767c65d25c4:880:888 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
    3767c65d25c4:880:888 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:880:887 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
    3767c65d25c4:880:887 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
    3767c65d25c4:880:887 [0] NCCL INFO NCCL_WORK_FIFO_DEPTH set by environment to 4194304.
    3767c65d25c4:880:887 [0] NCCL INFO comm 0x55ba65abd9d0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId a4000 commId 0xab55a18c6f2a4343 - Init COMPLETE
    3767c65d25c4:880:888 [1] NCCL INFO comm 0x55ba65ac2bd0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId a9000 commId 0xab55a18c6f2a4343 - Init COMPLETE
    #
    #                                                              out-of-place                       in-place          
    #       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong
    #        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       
    134217728      33554432     float     sum      -1    857.6  156.51  156.51      0    819.6  163.76  163.76      0
    268435456      67108864     float     sum      -1   1445.2  185.74  185.74      0   1441.9  186.17  186.17      0
    536870912     134217728     float     sum      -1   2789.9  192.43  192.43      0   2793.6  192.18  192.18      0
    3767c65d25c4:880:880 [1] NCCL INFO comm 0x55ba65abd9d0 rank 0 nranks 2 cudaDev 0 busId a4000 - Destroy COMPLETE
    3767c65d25c4:880:880 [1] NCCL INFO comm 0x55ba65ac2bd0 rank 1 nranks 2 cudaDev 1 busId a9000 - Destroy COMPLETE
    # Out of bounds values : 0 OK
    # Avg bus bandwidth    : 179.465 
    #

    ```