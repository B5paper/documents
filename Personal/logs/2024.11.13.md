* 什么时候需要开一个新函数？

    当变量名混乱有冲突，不好起新名字的时候可以尝试开一个新函数。

* openshmem 矩阵乘法性能测试第一版

    参见`ref_31`。

    output:

    ```
    shmem 4 process(es), time consumption: 24.70 secs
    cpu 1 process, time consumption: 151.37 secs
    result check, time consumption: 0.01 secs
    all results are correct.

    cpu 1 process, time consumption: 53.70 secs
    ```

    这个程序使用 pe 0 先将数据分发给其他 pe，然后开始计算，计算完成后，pe 0 再将数据收集回来。shmem 的 time consumption 包含了数据传输过程和计算过程。

    4 核的 24.7 秒相对于单核的 53.7 秒，只提高了 2 倍速度，说明通信占用了很长时间。能否让多个 pe 主动去拿 pe 0 中的数据？

    shmem 下的单进程只跑了 151 秒，时间是正常单进程的 3 倍，打开 top 后，看到在执行`if (my_pe == 0)`代码块时，其他的 3 个 pe 进程全部跑满，说明进程在主动 poll 数据，把内存 IO 占满，导致 pe 0 在处理数据时效率低下，最终导致整个程序的效率低下。 

    暂时的结论：

    1. shmem 对 user 的编程能力要求很高，如果 user 把 app 设计得非常得当，那么 shmem 的性能和 mpi 几乎相同。但是如果 user 的编程能力不够，app 设计得不好，那么 shmem 的下限会非常低。

* 尝试 pe 主动拿数据

    ```c
    #include <stdio.h>
    #include <shmem.h>

    static long data2;

    int main()
    {
        shmem_init();
        int my_pe = shmem_my_pe();
        int n_pes = shmem_n_pes();
        
        static int *data = NULL;
        if (my_pe == 0)
        {
            data = shmem_malloc(sizeof(int));
            *data = my_pe;
            data2 = data;
            printf("data: %p\n", data);
        }
        printf("pe %d, &data2: %p\n", my_pe, &data2);
        shmem_put64(&data2, &data2, 0, 1);
        shmem_barrier_all();
        printf("pe %d, data2: %p\n", my_pe, data2);

        printf("pe %d, here\n", my_pe);
        static int buf = -1;
        // data = data2;
        data = 0xff0000d0;
        shmem_get32(&buf, data, 1, 0);

        printf("pe %d, buf: %d\n", my_pe, buf);

        if (my_pe == 0)
        {
            shmem_free(data);
        }

        shmem_finalize();
        return 0;
    }
    ```

    output:

    ```
    pe 1, &data2: 0x5ba6b6c46020
    data: 0xff0000d0
    pe 0, &data2: 0x5afff1a88020
    pe 0, data2: 0xff0000d0
    pe 0, here
    pe 0, buf: 0
    pe 1, data2: (nil)
    pe 1, here
    pe 1, buf: 0

    ```

    输出完后，会卡住。不清楚原因。

* 有关景物所引发的思考

    假如我们被要求看到一个景物后，联想到随机一件事。那么这件事很大概率是在我们心里与景物联系最紧密的。因此分析我们联想到的内容，就可以分析我们的心理状态。有点像罗夏测试。反过来想，我们也可以把所想强行融合到景物上，对景物进行主观改造。

* 有关畸形环境与正确的道路

    假如我们遇到的所有环境都是畸形的，畸形环境之外还有正确的环境，我们可能会陷入局部最优，无法振荡出来。那么是否有一些方法让我们从畸形的环境后找到正确的规律呢？

    举个例子，假如周围所有人都在玩抖音，我们如何才能有机会发现抖音之外的正确道路呢？