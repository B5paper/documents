* `ssh -W <target_ip>:<port> <user>@<jump_ip>`

    `ssh -W`表示登陆 jump host 的 ssh，并将当前窗口的所有 stdin, stdout 都转发到 target host 上。这个功能通常只能用于转发 ssh 数据。

    如果`<target_ip>:<port>`被设置为 target host 上的`nc -l <port>`，那么会报错：

    ```
    channel 0: open failed: connect failed: Connection refused
    stdio forwarding failed
    ```

    由此可见，这个命令可能并不是个通用命令，而是专门用于跳板机的 ssh 配套命令。

    `<target_ip>`通常使用`%h`表示，`<port>`通常使用`%p`表示，这样可以直接匹配到需要连接的主机：

    `ssh -o ProxyCommand="ssh -W %h:%p <user>@<jump_host>" <user>@<target_host>`

    此时`%h`会被自动替换成`<target_host>`，而`%p`会被自动替换成`22`。
    
    跳板机的 sshd 需要开启`AllowTcpForwarding yes`，默认情况下是开启的。

    `~/.ssh/config`的写法如下：

    ```
    Host target-host
        HostName 目标主机真实IP
        User 目标主机用户
        ProxyCommand ssh -W %h:%p 跳板机用户@跳板机IP
    ```