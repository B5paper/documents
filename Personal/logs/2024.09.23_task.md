* [v] 调研 mlnx port 强制速率协商

    feedback:

    1. `ibstat`或`ibstatus`可以得到当前协商的速率

    2. `sudo ibportstate 1 1 query`可以看到设备能力，当前状态等的详细信息

    3. `sudo ibportstate 1 1 espeed 1`，尝试将 ext speed 修改为 1。这里的 1 是 10 进制，会被转换成 2 进制去和驱动代码中的 mask 匹配。

    4. 尝试将 link rate 强制修改为 EDR

        `sudo mlxlink -d mlx5_0 --link_mode_force -s EDR`

        output:

        ```
        Operational Info
        ----------------
        State                              : Active 
        Physical state                     : LinkUp 
        Speed                              : IB-SDR 
        Width                              : 4x 
        FEC                                : No FEC 
        Loopback Mode                      : No Loopback 
        Auto Negotiation                   : ON 

        Supported Info
        --------------
        Enabled Link Speed                 : 0x00000001 (SDR) 
        Supported Cable Speed              : 0x00000001 (SDR) 

        Troubleshooting Info
        --------------------
        Status Opcode                      : 0 
        Group Opcode                       : N/A 
        Recommendation                     : No issue was observed 

        Tool Information
        ----------------
        Firmware Version                   : 16.35.3502 
        MFT Version                        : mft 4.28.0-92 

        Configuring Port Speeds...
        

        Errors
        ------
        Sending PTYS (Configuring port speeds) raised the following exception: EDR is not supported by Device!
        Supported Speeds Are: SDR
        ```

    5. 尝试将速率强制修改为 SDR

        `sudo mlxlink -d mlx5_0 --link_mode_force -s SDR`

        output:

        ```
        Operational Info
        ----------------
        State                              : Active 
        Physical state                     : LinkUp 
        Speed                              : IB-SDR 
        Width                              : 4x 
        FEC                                : No FEC 
        Loopback Mode                      : No Loopback 
        Auto Negotiation                   : ON 

        Supported Info
        --------------
        Enabled Link Speed                 : 0x00000001 (SDR) 
        Supported Cable Speed              : 0x00000001 (SDR) 

        Troubleshooting Info
        --------------------
        Status Opcode                      : 0 
        Group Opcode                       : N/A 
        Recommendation                     : No issue was observed 

        Tool Information
        ----------------
        Firmware Version                   : 16.35.3502 
        MFT Version                        : mft 4.28.0-92 

        Configuring Port Speeds...
        

        Errors
        ------
        Sending PTYS (Configuring port speeds) raised the following exception: Invalid speed configurations
        ```

    6. 使用 vscode 调试 sudo 程序

        核心是需要 gdb 由 sudo 启动。

        可以在`launch.json`里加一行：

        `"miDebuggerPath": "/home/hlc/.local/bin/sudo_gdb.sh"`

        `sudo_gdb.sh`里只要写一行：

        ```bash
        #!/bin/bash
        sudo gdb "$@"
        ```

        然后`sudo chmod +x sudo_gdb.sh`。

        接着在 vscode 的 intergrated terminal 里输入`sudo echo 1`，正常输入密码。此时这个 terminal 里，root 权限会持续开启一段时间，使用`sudo`运行其他程序不需要再输入密码。

        这个时候就可以在 vscode 里运行 F5 调试程序了。

    7. 有时间可以追一追为什么 cable 不支持高速率。

    8. cache

        * mellanox 的 firmware:

            <https://network.nvidia.com/support/firmware/nic/>

        * Firmware Management

            <https://docs.nvidia.com/networking/software/firmware-management/index.html#mft>

        * NVIDIA Firmware Tools (MFT) 

            <https://docs.nvidia.com/networking/display/mftv421/mlxlink+utility>

        * How to debug programs with "sudo" in VSCODE

            <https://stackoverflow.com/questions/40033311/how-to-debug-programs-with-sudo-in-vscode>

        * How can i change to ib card speed from IB-SDR to IB-QDR?

            <https://forums.developer.nvidia.com/t/how-can-i-change-to-ib-card-speed-from-ib-sdr-to-ib-qdr/206512>

        * NVIDIA Firmware Tools (MFT) 

            <https://docs.nvidia.com/networking/display/mftv422/using+mlxconfig#Usingmlxconfig-UsingmlxconfigtoSetIB/ETHParameters>

        * NVIDIA ConnectX-7 Adapter Cards User Manual

            <https://docs.nvidia.com/networking/display/connectx7vpi/setting+high-speed-port+link+type>

        * IBPORTSTATE - handle port (physical) state and link speed of an InfiniBand port

            <https://manpages.ubuntu.com/manpages/focal/en/man8/ibportstate.8.html>

        * Set a upper bandwidth limit for Infiniband HCAs

            <https://serverfault.com/questions/770435/set-a-upper-bandwidth-limit-for-infiniband-hcas>

* [v] cache tabs

    feedback:

    * cached tabs

        * 计算机网络-以太网链路聚合

        <https://zhuanlan.zhihu.com/p/679496515>

        * H3C 交换机常见配置问题FAQ-6W102

            <https://www.h3c.com/cn/Service/Document_Software/Document_Center/Home/Switches/00-Public/Quick_Starts/FAQ/H3C_CJWT_FAQ_Long/?CHID=560342#_Toc107479941>

        * H3C 交换机常见配置问题FAQ-6W102

            <https://www.h3c.com/cn/Service/Document_Software/Document_Center/Home/Switches/00-Public/Quick_Starts/FAQ/H3C_CJWT_FAQ_Long/?CHID=560342>

        * H3C光模块和光链路运维指导书-6W100

            <https://www.h3c.com/cn/d_202208/1666054_30005_0.htm>

        * AI超算下的光互联：光模块、AOC与DAC

            <https://new.qq.com/rain/a/20230709A03JMC00>

        * Mellanox ConnectX-5 Infiniband + LR4 Transceivers = 10GBit/s SDR?!

            <https://forums.servethehome.com/index.php?threads/mellanox-connectx-5-infiniband-lr4-transceivers-10gbit-s-sdr.35776/>

        * 21张图详解交换机MAC地址表的五大要素：MAC地址、VLAN、出接口等 

            <https://www.sohu.com/a/488645722_121206653>

        * Bootlin Live #0, live video podcast on embedded Linux

            <https://bootlin.com/>

        * How to Change MAC Address in Linux

            <https://beebom.com/how-change-mac-address-linux/>

        * Bootlin Elixir Cross Referencer

            <https://elixir.bootlin.com/linux/v5.19/A/ident/ib_device_ops>

        * The Elixir Cross Referencer

            <https://github.com/bootlin/elixir>

        * Elixir Cross Referencer: new way to browse kernel sources

            <https://bootlin.com/blog/elixir/>

        * How to Change Your MAC Address on Linux

            <https://www.makeuseof.com/how-to-change-mac-address-on-linux/>

        * 光模块简介

            <https://cshihong.github.io/2020/08/16/%E5%85%89%E6%A8%A1%E5%9D%97%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/>

* [ ] reorg
